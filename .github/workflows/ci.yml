name: CI
on:
  push:
    branches:
      - main
    # Trigger on version tags
    tags:
      - 'v[0-9]+\.[0-9]+\.[0-9]+-OP_v[0-9]+\.[0-9]+\.[0-9]+-CN_v[0-9]+\.[0-9]+\.[0-9]+'
      - 'v[0-9]+\.[0-9]+\.[0-9]+-OP_v[0-9]+\.[0-9]+\.[0-9]+-CN_v[0-9]+\.[0-9]+\.[0-9]+-rc(?:[0-9]+|\.[0-9]+)'
  pull_request:
  workflow_dispatch:
    # Inputs the workflow accepts.
    inputs:
      version:
        # Friendly description to be shown in the UI instead of 'name'
        description: "Semver type of new version (major / minor / patch)"
        # Input has to be provided for the workflow to run
        required: true
        type: choice
        options:
          - patch
          - minor
          - major

jobs:
  test:
    uses: ./.github/workflows/test.yml
    with:
      GO_VERSION: '1.20'
